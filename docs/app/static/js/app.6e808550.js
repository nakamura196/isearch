(function(t){function e(e){for(var r,n,c=e[0],o=e[1],l=e[2],h=0,v=[];h<c.length;h++)n=c[h],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&v.push(s[n][0]),s[n]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r]);u&&u(e);while(v.length)v.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],r=!0,c=1;c<a.length;c++){var o=a[c];0!==s[o]&&(r=!1)}r&&(i.splice(e--,1),t=n(n.s=a[0]))}return t}var r={},s={app:0},i=[];function n(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=r,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(a,r,function(e){return t[e]}.bind(null,r));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],o=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var u=o;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var r=a("8a23"),s=a.n(r);s.a},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-app-bar",[a("v-toolbar-title",[t._v(t._s(t.config.header))])],1),a("v-content",[a("v-container",[a("v-card",{staticClass:"my-5"},[a("v-card-text",[a("v-text-field",{attrs:{label:"Full text search"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search_move(e)}},model:{value:t.advanced_search["Full text search"],callback:function(e){t.$set(t.advanced_search,"Full text search",e)},expression:"advanced_search['Full text search']"}}),a("v-btn",{attrs:{color:"primary"},on:{click:t.search_move}},[t._v("Search")]),a("v-btn",{staticClass:"ml-4",on:{click:t.reset}},[t._v("Reset")])],1)],1)],1),a("div",{staticClass:"pb-5",staticStyle:{"background-color":"#eeeeee"}},[a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"3"}},[a("h3",[t._v(t._s(((t.query.page-1)*t.query.size+1).toLocaleString())+" - "+t._s((t.query.page*t.query.size>t.total?t.total:t.query.page*t.query.size).toLocaleString())+" of "+t._s(t.total.toLocaleString())+" results")])]),a("v-col",{attrs:{cols:"12",sm:"9"}},[a("v-row",[a("v-col",[a("v-select",{attrs:{items:t.computed_items_sort,label:"Sort by"},on:{change:t.sort_move},model:{value:t.query.sort,callback:function(e){t.$set(t.query,"sort",e)},expression:"query.sort"}})],1),a("v-col",[a("v-select",{attrs:{items:[20,50,100],label:"Items per page"},on:{change:t.size_move},model:{value:t.query.size,callback:function(e){t.$set(t.query,"size",e)},expression:"query.size"}})],1),a("v-col",[a("span",{staticClass:"mr-2"},[t._v("Layout")]),a("v-btn-toggle",{attrs:{mandatory:""},model:{value:t.layout,callback:function(e){t.layout=e},expression:"layout"}},[a("v-btn",[a("i",{staticClass:"fas fa-th-large"})]),a("v-btn",[a("i",{staticClass:"fas fa-th-list"})])],1)],1)],1)],1)],1),a("v-card",{staticStyle:{"background-color":"#eeeeee"},attrs:{outlined:""}},[a("v-card-text",[a("span",{staticClass:"mr-2"},[t._v("Filtered by")]),t._l(t.advanced_search_display,(function(e,r){return a("span",{key:"a_"+r},[e!=[]&&""!=e?a("v-btn",{staticClass:"mx-1 my-1",attrs:{color:"primary",small:""},on:{click:function(e){t.advanced_search[r]="",t.search(!0)}}},[t._v(" [Advanced] "+t._s(r.replace(".keyword",""))+": "),a("b",{staticClass:"mx-2",class:"Phone/Word"==r?"phone":""},[t._v(t._s(e instanceof Array?e.join(", "):e))]),a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])]):t._e()],1)})),t._l(t.facet_search,(function(e,r){return a("span",{key:"f_"+r},[e!=[]&&""!=e?a("v-btn",{staticClass:"mx-1 my-1",attrs:{color:"primary",small:""},on:{click:function(e){t.facet_search[r]="",t.search(!0)}}},[t._v(" [Facet] "+t._s(r.replace(".keyword",""))+": "),a("b",{staticClass:"mx-2",class:"Phone/Word"==r?"phone":""},[t._v(t._s(e instanceof Array?e.join(", "):e))]),a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])]):t._e()],1)}))],2)],1)],1)],1),a("v-container",{staticClass:"mt-5"},[a("v-row",[a("v-col",{staticStyle:{"background-color":"#eeeeee"},attrs:{cols:"12",sm:"3"}},[t.total>0?[a("h3",{staticClass:"mb-5"},[t._v("Refine your search")]),t._l(t.results.aggregations,(function(e,r){return["Full text search"!=r&&e.buckets.length>0?a("v-card",{key:"agg_"+r,staticClass:"my-5",attrs:{outlined:""}},[a("v-list",{attrs:{subheader:"","two-line":"",flat:""}},[a("v-subheader",[t._v(t._s(r))]),a("div",{staticStyle:{"max-height":"400px","overflow-y":"auto"}},[a("v-list-item-group",{attrs:{multiple:""}},[t._l(e.buckets,(function(e,s){return[""!=e.key?a("v-list-item",{key:"bucket_"+s,scopedSlots:t._u([{key:"default",fn:function(s){s.active,s.toggle;return[a("v-list-item-action",[a("v-checkbox",{attrs:{color:"primary"},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"bucket.value"}})],1),a("v-list-item-content",[a("v-list-item-title",{class:"Phone/Word"==r?"phone":""},[t._v(t._s(e.key))])],1),a("v-list-item-action",[a("v-btn",{attrs:{icon:""}},[t._v(t._s(e.doc_count))])],1)]}}],null,!0)}):t._e()]}))],2)],1),a("v-card-text",[a("v-btn",{attrs:{small:"",color:"primary"},on:{click:t.facet_filter}},[t._v("Search")])],1)],1)],1):t._e()]}))]:t._e()],2),a("v-col",{attrs:{cols:"12",sm:"9"}},[t.total>0?[a("div",{staticClass:"text-center"},[a("v-pagination",{attrs:{length:t.pagination_length,"total-visible":7},on:{input:function(e){return t.page_move()}},model:{value:t.query.page,callback:function(e){t.$set(t.query,"page",e)},expression:"query.page"}})],1),0==t.layout?[a("v-row",t._l(t.results.hits.hits,(function(e,r){return a("v-col",{key:"result_"+r,attrs:{cols:"6",sm:"3"}},[a("v-card",[a("a",{attrs:{target:"_blank",href:e._related[0]}},[a("v-img",{staticClass:"grey lighten-2",attrs:{src:e._thumbnail[0]}})],1),a("v-card-text",[a("a",{attrs:{href:e._related[0],target:"_blank"}},[a("b",[t._v(t._s(e.Title[0]))])])])],1)],1)})),1)]:t._l(t.results.hits.hits,(function(e,r){return a("v-card",{key:"result_"+r,staticClass:"my-5"},[a("v-card-text",[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"3"}},[a("a",{attrs:{target:"_blank",href:e._related[0]}},[a("v-img",{staticClass:"grey lighten-2",attrs:{src:e._thumbnail[0]}})],1)]),a("v-col",{attrs:{cols:"12",sm:"9"}},[a("a",{attrs:{href:e._related[0],target:"_blank"}},[a("b",[t._v(t._s(e.Title[0]))])]),a("v-card-text",[t._l(e,(function(e,r){return[-1==r.indexOf("_")&&"Title"!=r?a("div",{key:r},[a("b",[t._v(t._s(r)+" :")]),t._v(" "+t._s(e.join(", "))+" ")]):t._e()]}))],2)],1)],1)],1)],1)})),a("div",{staticClass:"text-center"},[a("v-pagination",{attrs:{length:t.pagination_length,"total-visible":7},on:{input:function(e){return t.page_move()}},model:{value:t.query.page,callback:function(e){t.$set(t.query,"page",e)},expression:"query.page"}})],1)]:t._e()],2)],1)],1)],1),a("v-footer",{staticClass:"mt-5",attrs:{dark:!0}},[a("v-container",[a("p",{staticClass:"text-center my-5"},[a("a",{staticStyle:{color:"white"},attrs:{href:"https://github.com/nakamura196/isearch"}},[t._v("https://github.com/nakamura196/isearch")])])])],1)],1)},i=[],n=(a("a4d3"),a("e01a"),a("d28b"),a("99af"),a("4de4"),a("c975"),a("d81d"),a("4e827"),a("a9e3"),a("b64b"),a("d3b7"),a("ac1f"),a("6062"),a("3ca3"),a("5319"),a("841c"),a("2ca0"),a("ddb0"),a("2909")),c=a("bc3a"),o=a.n(c),l=50,u={data:function(){return{config:{u:"",header:"",items_sort:{}},query:{query:{},aggs:{},size:50,from:0,page:1,sort:"Title Asc"},advanced_search:{},advanced_search_display:{},facet_search:{},index:{},data_all:[],data_filtered:[],results:[],facets:{},layout:0}},created:function(){var t=this,e=this.$route.query;console.log(e),e.u&&(this.config.u=e.u,o.a.get(e.u).then((function(a){var r=a.data;t.config.header=r.label;for(var s=[],i=r.manifests,n=1,c=t.index,o=0;o<i.length;o++){var u=i[o],h={_thumbnail:[u.thumbnail],_related:[u.related],_id:[u["@id"]],Title:[u.label]};u.description&&(h.Description=[u.description]);var v=u.metadata;if(v)for(var f=0;f<v.length;f++){var d=v[f],_=d.value;_ instanceof Array||(_=[_]),h[d.label]=_}var p="",y=n-1;for(var g in h){c[g]||(c[g]={});for(var m=h[g],b=0;b<m.length;b++){var k=m[b];null==k||k.startsWith("http")||(c[g][k]||(c[g][k]=[]),c[g][k].push(y),p+=k+" ")}}var x="Full text search";c[x]||(c[x]={}),c[x][p]||(c[x][p]=[]),c[x][p].push(y),s.push(h),n+=1}t.index=c;var q=[],w={};for(var C in c)-1==C.indexOf("_")&&(w[C+" Asc"]={value:C,type:"asc"},w[C+" Desc"]={value:C,type:"desc"},t.facet_search[C]=[],q.push({label:C,field:C+".keyword"}));t.config.items_sort=w,t.data_all=s;for(var S={},O=0;O<q.length;O++){var V=q[O];S[V.label]={terms:{field:V.field,order:{_count:"desc"},size:l}}}t.query.aggs=S,e.advanced&&(t.advanced_search=JSON.parse(e.advanced)),e.facet&&(t.facet_search=JSON.parse(e.facet)),e.layout&&(t.layout=Number(e.layout)),e.sort&&(t.query.sort=e.sort),e.size&&(t.query.size=Number(e.size)),t.search(!0)})))},methods:{search:function(t){if(window.scrollTo(0,0),t){var e=this.createQuery();this.query=e;var a=this.filter(this.query),r=this.getDataFiltered(a);this.data_filtered=r;var s=this.createFacets(a,this.query.aggs);this.facets=s}this.data_filtered=this.sort_data(this.data_filtered,this.query.sort);var i=this.getResult(this.data_filtered,(this.query.page-1)*this.query.size,this.query.size),n={aggregations:this.facets,hits:{hits:i,total:{relation:this.query.sort,value:this.data_filtered.length}}};for(var c in this.advanced_search)this.advanced_search_display[c]=this.advanced_search[c];this.update_param(),this.results=n},createQuery:function(){var t={},e=[],a=[];for(var r in t.bool={filter:e,must:a},this.advanced_search){var s=this.advanced_search[r];""!=s&&e.push(this.createMustQuery(r,[s],!1))}for(var i in this.facet_search){var n=this.facet_search[i];0!=n.length&&e.push(this.createFilterQuery(i,n))}var c=this.query;return c.query=t,c},createMustQuery:function(t,e,a){for(var r=[],s=0;s<e.length;s++){var i=e[s];if(""!=i){var n={};a&&(t+=".keyword"),n[t]=i,r.push({match_phrase:n})}}return{bool:{should:r}}},createFilterQuery:function(t,e){for(var a=[],r=0;r<e.length;r++){var s=e[r];if(""!=s){var i={};i[t+".keyword"]=s,a.push({match_phrase:i})}}return{bool:{should:a}}},getDataFiltered:function(t){for(var e=[],a=0;a<t.length;a++)e.push(this.data_all[t[a]]);return e},sort_data:function(t,e){var a=this.config.items_sort[e],r=!0;"desc"==a.type&&(r=!1);var s=a.value,i=1,n=-1;r||(i*=-1,n*=-1);var c="Title";return t.sort((function(t,e){return t[s][0]>e[s][0]?i:t[s][0]<e[s][0]?n:t[c][0]>e[c][0]?i:t[c][0]<e[c][0]?n:0})),t},getResult:function(t,e,a){var r=[],s=e+a;s>this.data_filtered.length&&(s=this.data_filtered.length);for(var i=e;i<s;i++)r.push(this.data_filtered[i]);return r},createFacets:function(t,e){var a=this,r={},s=function(s){var i=e[s].terms,c=Number(i.size),o=i.field.replace(".keyword",""),l=a.index[o],u={},h=function(e){var a=new Set(Object(n["a"])(new Set(t)).filter((function(t){return new Set(l[e]).has(t)}))),r=a.size;r>0&&(u[e]=r)};for(var v in l)h(v);var f=Object.keys(u).map((function(t){return{key:t,value:u[t]}}));f.sort((function(t,e){return t.value<e.value?1:t.value>e.value?-1:0})),c>f.length&&(c=f.length);for(var d=[],_=0;_<c;_++){var p=f[_].key,y={key:p,doc_count:f[_].value};a.facet_search[o]||(a.facet_search[o]=[]),-1!=a.facet_search[o].indexOf(p)&&(y.value=!0),d.push(y)}r[s]={buckets:d}};for(var i in e)s(i);return r},filter:function(t){for(var e=this.index,a=[],r=0;r<this.data_all.length;r++)a.push(r);var s=t.query.bool,i=new Set(a);for(var c in s)for(var o=s[c],l=function(t){for(var a=o[t].bool.should,r=new Set([]),s=0;s<a.length;s++){var c=a[s]["match_phrase"];for(var l in c){var u=c[l],h=[];if(-1==l.indexOf(".keyword")){var v=e[l];for(var f in v)-1!=f.toLowerCase().indexOf(u.toLowerCase())&&(h=h.concat(v[f]))}else{l=l.replace(".keyword","");var d=e[l];for(var _ in d)_.toLowerCase()==u.toLowerCase()&&(h=h.concat(d[_]))}var p=new Set(h);r=new Set([].concat(Object(n["a"])(r),Object(n["a"])(p)))}}i=new Set(Object(n["a"])(i).filter((function(t){return r.has(t)})))},u=0;u<o.length;u++)l(u);var h=[],v=!0,f=!1,d=void 0;try{for(var _,p=i[Symbol.iterator]();!(v=(_=p.next()).done);v=!0){var y=_.value;h.push(y)}}catch(g){f=!0,d=g}finally{try{v||null==p.return||p.return()}finally{if(f)throw d}}return h},page_move:function(){this.search()},sort_move:function(){this.search()},size_move:function(){this.search(!0)},search_move:function(){for(var t in this.facet_search){var e=this.facet_search[t];e=e instanceof Array?[]:"",this.facet_search[t]=e}1!=this.query.page&&(this.query.page=1,this.sort="Title Asc"),this.search(!0)},update_param:function(){var t={u:this.config.u,advanced:JSON.stringify(this.advanced_search),facet:JSON.stringify(this.facet_search),layout:this.layout,size:this.query.size,sort:this.query.sort};this.$router.replace({query:t},(function(){}),(function(){}))},init_param:function(){for(var t in this.query.query={},this.query.size=50,this.query.from=0,this.query.page=1,this.query.sort="Title Asc",this.advanced_search){var e=this.advanced_search[t];e=e instanceof Array?[]:"",this.advanced_search[t]=e}for(var a in this.facet_search){var r=this.facet_search[a];r=r instanceof Array?[]:"",this.facet_search[a]=r}this.update_param()},reset:function(){this.init_param(),this.search(!0)},facet_search_move:function(t,e,a){this.init_param(),this[t][e]=a,this.search(!0)},facet_filter:function(){for(var t in this.facet_search){var e=this.facet_search[t];e=e instanceof Array?[]:"",this.facet_search[t]=e}var a=this.results.aggregations;for(var r in a)for(var s=a[r].buckets,i=0;i<s.length;i++){var n=s[i];n.value&&(this.facet_search[r]||(this.facet_search[r]=[]),this.facet_search[r].push(n.key))}this.search(!0)}},watch:{layout:function(){this.update_param()}},computed:{total:function(){var t=0;return this.results.hits&&(t=this.results.hits.total.value),t},pagination_length:function(){return Math.ceil(this.total/this.query.size)},computed_items_sort:function(){var t=[];for(var e in this.config.items_sort)t.push(e);return t}}},h=u,v=(a("034f"),a("2877")),f=a("6544"),d=a.n(f),_=a("7496"),p=a("40dc"),y=a("8336"),g=a("a609"),m=a("b0af"),b=a("99d9"),k=a("ac7c"),x=a("62ad"),q=a("a523"),w=a("a75b"),C=a("553a"),S=a("adda"),O=a("8860"),V=a("da13"),z=a("1800"),j=a("5d23"),T=a("1baa"),F=a("891e"),A=a("0fd9"),L=a("b974"),P=a("e0c7"),$=a("8654"),I=a("2a7f"),M=Object(v["a"])(h,s,i,!1,null,null,null),N=M.exports;d()(M,{VApp:_["a"],VAppBar:p["a"],VBtn:y["a"],VBtnToggle:g["a"],VCard:m["a"],VCardText:b["a"],VCheckbox:k["a"],VCol:x["a"],VContainer:q["a"],VContent:w["a"],VFooter:C["a"],VImg:S["a"],VList:O["a"],VListItem:V["a"],VListItemAction:z["a"],VListItemContent:j["a"],VListItemGroup:T["a"],VListItemTitle:j["b"],VPagination:F["a"],VRow:A["a"],VSelect:L["a"],VSubheader:P["a"],VTextField:$["a"],VToolbarTitle:I["a"]});var J=a("8c4f");r["a"].use(J["a"]);var Q=new J["a"]({routes:[]}),R=a("f309");r["a"].use(R["a"]);var D=new R["a"]({icons:{iconfont:"mdi"}});r["a"].config.productionTip=!1,new r["a"]({router:Q,vuetify:D,render:function(t){return t(N)}}).$mount("#app")},"8a23":function(t,e,a){}});
//# sourceMappingURL=app.6e808550.js.map